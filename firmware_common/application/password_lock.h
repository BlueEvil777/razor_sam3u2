/*!*********************************************************************************************************************
@file password_lock.h                                                                
@brief Header file for password_lock
**********************************************************************************************************************/

#ifndef __PASSWORD_LOCK_H
#define __PASSWORD_LOCK_H

#include <eief1-pcb-01.h>
#include <configuration.h>

/**********************************************************************************************************************
Type Definitions
**********************************************************************************************************************/

/*!
@enum PasswordStateType

@brief Logical names for the different states of the password authentication.
*/
typedef enum {PASSWORD_NOT_READY, PASSWORD_LOCKED, PASSWORD_UNLOCKED, PASSWORD_CHANGE} PasswordStateType;

/*!
@struct ButtonInputBufferType

@brief Holds a defined sized buffer for input buttons.
*/
typedef struct
{
	u8 u8Size;
	ButtonNameType *p_arryBuffer;
} ButtonInputBufferType;
/**********************************************************************************************************************
Function Declarations
**********************************************************************************************************************/

/*------------------------------------------------------------------------------------------------------------------*/
/*! @publicsection */                                                                                            
/*--------------------------------------------------------------------------------------------------------------------*/


/*------------------------------------------------------------------------------------------------------------------*/
/*! @protectedsection */                                                                                            
/*--------------------------------------------------------------------------------------------------------------------*/
void PasswordLockInitialize(void);
void PasswordLockRunActiveState(void);


/*------------------------------------------------------------------------------------------------------------------*/
/*! @privatesection */                                                                                            
/*--------------------------------------------------------------------------------------------------------------------*/
bool waitingForBtn(ButtonNameType);
bool updateBtnInputBuffer(ButtonInputBufferType*);
short checkPassword(ButtonInputBufferType*, const ButtonInputBufferType*);
static void clearLeds(void);

/***********************************************************************************************************************
State Machine Declarations
***********************************************************************************************************************/
static void PasswordLockSM_Idle(void);    
static void PasswordLockSM_Error(void);         



/**********************************************************************************************************************
Constants / Definitions
**********************************************************************************************************************/
#define P_ARY_DEFAULT_PASSWORD (ButtonNameType[]) {BUTTON0,BUTTON1,BUTTON2}
#define U8_DEFAULT_PASSWORD_LENGTH (u8) 3
#define U8_MAX_PASSWORD_SIZE (u8) 10

#endif /* __PASSWORD_LOCK_H */

/*--------------------------------------------------------------------------------------------------------------------*/
/* End of File                                                                                                        */
/*--------------------------------------------------------------------------------------------------------------------*/
